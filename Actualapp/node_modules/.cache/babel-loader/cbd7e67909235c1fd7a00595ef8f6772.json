{"ast":null,"code":"// Taken from https://github.com/WalletConnect/walletconnect-monorepo/blob/master/packages/qrcode-modal/src/browser.ts\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { getColorMode } from '../../colorMode';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { replaceInTemplate } from '../../utils/replace-in-template';\nimport { alertTemplates } from './alert-templates';\nimport { preparePairingAlert } from './PairingAlert';\nlet lastFocusedElement;\nlet document;\n\nif (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n  document = window.document;\n}\n\nconst timeout = {};\n\nconst addQR = dataString => {\n  if (typeof dataString === 'string') {\n    return `<div id=\"beacon--qr__container\"><div id=\"beacon--qr__copy__container\"><button class=\"beacon-modal__button--outline\" id=\"beacon--qr__copy\">Copy</button></div></div>${dataString}`;\n  }\n\n  return '';\n};\n\nconst formatAlert = (id, body, title, buttons, hasPairingPayload) => {\n  const callToAction = title;\n  const buttonsHtml = buttons.map((button, index) => `<button id=\"beacon-alert-${id}-${index}\" class=\"beacon-modal__button${button.style === 'outline' ? '--outline' : ''}\">${button.text}</button>`);\n  let allStyles = alertTemplates.default.css;\n\n  if (hasPairingPayload) {\n    allStyles += alertTemplates.pair.css;\n  }\n\n  let alertContainer = alertTemplates.container;\n  alertContainer = replaceInTemplate(alertContainer, 'main', hasPairingPayload ? alertTemplates.pair.html : alertTemplates.default.html);\n  alertContainer = replaceInTemplate(alertContainer, 'callToAction', callToAction);\n  alertContainer = replaceInTemplate(alertContainer, 'buttons', buttonsHtml.join(' '));\n  alertContainer = replaceInTemplate(alertContainer, 'body', body);\n  alertContainer = replaceInTemplate(alertContainer, 'id', id);\n\n  if (alertContainer.indexOf('{{') >= 0) {\n    const start = alertContainer.indexOf('{{');\n    const end = alertContainer.indexOf('}}');\n    console.error('Not all placeholders replaced!', alertContainer.substr(start, end - start));\n    throw new Error('Not all placeholders replaced!');\n  }\n\n  return {\n    style: allStyles,\n    html: alertContainer\n  };\n};\n/**\n * Close an alert by ID\n *\n * @param id ID of alert\n */\n\n\nconst closeAlert = id => new Promise(resolve => {\n  var _a;\n\n  const wrapper = document.getElementById(`beacon-alert-wrapper-${id}`);\n\n  if (!wrapper) {\n    return resolve();\n  }\n\n  const elm = (_a = wrapper.shadowRoot) === null || _a === void 0 ? void 0 : _a.getElementById(`beacon-alert-modal-${id}`);\n\n  if (elm) {\n    const animationDuration = 300;\n    const localTimeout = timeout[id];\n\n    if (localTimeout) {\n      clearTimeout(localTimeout);\n      timeout[id] = undefined;\n    }\n\n    elm.className = elm.className.replace('fadeIn', 'fadeOut');\n    window.setTimeout(() => {\n      const parent = wrapper.parentNode;\n\n      if (parent) {\n        parent.removeChild(wrapper);\n      }\n\n      if (lastFocusedElement) {\n        ;\n        lastFocusedElement.focus(); // set focus back to last focussed element\n      }\n\n      resolve();\n    }, animationDuration);\n  } else {\n    resolve();\n  }\n});\n/**\n * Close all alerts\n */\n\n\nconst closeAlerts = () => __awaiter(void 0, void 0, void 0, function* () {\n  return new Promise(resolve => __awaiter(void 0, void 0, void 0, function* () {\n    const openAlertElements = document.querySelectorAll('[id^=\"beacon-alert-wrapper-\"]');\n\n    if (openAlertElements.length > 0) {\n      const alertIds = [];\n      openAlertElements.forEach(element => __awaiter(void 0, void 0, void 0, function* () {\n        alertIds.push(element.id.split('-')[3]);\n      }));\n      yield Promise.all(alertIds.map(closeAlert));\n      resolve();\n    } else {\n      resolve();\n    }\n  }));\n});\n/**\n * Show an alert\n *\n * @param alertConfig The configuration of the alert\n */\n// eslint-disable-next-line complexity\n\n\nconst openAlert = alertConfig => __awaiter(void 0, void 0, void 0, function* () {\n  var _a, _b;\n\n  const body = alertConfig.body;\n  const title = alertConfig.title;\n  const timer = alertConfig.timer;\n  const pairingPayload = alertConfig.pairingPayload;\n  const disclaimer = alertConfig.disclaimerText; // eslint-disable-next-line @typescript-eslint/unbound-method\n\n  const closeButtonCallback = alertConfig.closeButtonCallback;\n  yield closeAlerts();\n  const id = (yield generateGUID()).split('-').join('');\n  const shadowRootEl = document.createElement('div');\n  shadowRootEl.setAttribute('id', `beacon-alert-wrapper-${id}`);\n  const shadowRoot = shadowRootEl.attachShadow({\n    mode: 'open'\n  });\n  const wrapper = document.createElement('div');\n  wrapper.setAttribute('tabindex', `0`); // Make modal focussable\n\n  shadowRoot.appendChild(wrapper);\n  const buttons = [...((_b = (_a = alertConfig.buttons) === null || _a === void 0 ? void 0 : _a.map(button => {\n    var _a, _b;\n\n    return {\n      text: button.text,\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      actionCallback: (_a = button.actionCallback) !== null && _a !== void 0 ? _a : () => Promise.resolve(),\n      style: (_b = button.style) !== null && _b !== void 0 ? _b : 'outline'\n    };\n  })) !== null && _b !== void 0 ? _b : [])];\n  const formattedBody = pairingPayload ? addQR(body) : body !== null && body !== void 0 ? body : '';\n  const {\n    style,\n    html\n  } = formatAlert(id, formattedBody, title, buttons, !!(pairingPayload === null || pairingPayload === void 0 ? void 0 : pairingPayload.p2pSyncCode));\n  wrapper.innerHTML = html;\n  const styleEl = document.createElement('style');\n  styleEl.textContent = style;\n  shadowRoot.appendChild(styleEl);\n\n  if (timer) {\n    timeout[id] = window.setTimeout(() => __awaiter(void 0, void 0, void 0, function* () {\n      yield closeAlert(id);\n    }), timer);\n  }\n\n  document.body.prepend(shadowRootEl);\n  const closeButton = shadowRoot.getElementById(`beacon-alert-${id}-close`);\n\n  const closeButtonClick = () => __awaiter(void 0, void 0, void 0, function* () {\n    if (closeButtonCallback) {\n      closeButtonCallback();\n    }\n\n    yield closeAlert(id);\n  });\n\n  if (disclaimer) {\n    const disclaimerContainer = shadowRoot.getElementById(`beacon--disclaimer`);\n\n    if (disclaimerContainer) {\n      disclaimerContainer.innerHTML = disclaimer;\n    }\n  }\n\n  const colorMode = getColorMode();\n  const elm = shadowRoot.getElementById(`beacon-alert-modal-${id}`);\n\n  if (elm) {\n    elm.classList.add(`theme__${colorMode}`);\n    elm.addEventListener('click', closeButtonClick); // Backdrop click dismisses alert\n  }\n\n  const modal = shadowRoot.querySelectorAll('.beacon-modal__wrapper');\n\n  if (modal.length > 0) {\n    modal[0].addEventListener('click', event => {\n      event.stopPropagation();\n    });\n  }\n\n  lastFocusedElement = document.activeElement; // Store which element has been focussed before the alert is shown\n\n  wrapper.focus(); // Focus alert for accessibility\n\n  buttons.forEach((button, index) => {\n    const buttonElement = shadowRoot.getElementById(`beacon-alert-${id}-${index}`);\n\n    if (buttonElement) {\n      buttonElement.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n        yield closeAlert(id);\n\n        if (button.actionCallback) {\n          yield button.actionCallback();\n        }\n      }));\n    }\n  });\n\n  if (closeButton) {\n    closeButton.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n      yield closeButtonClick();\n    }));\n  }\n\n  window.addEventListener('keydown', event => __awaiter(void 0, void 0, void 0, function* () {\n    if (event.key === 'Escape') {\n      yield closeButtonClick();\n    }\n  }));\n\n  if (pairingPayload) {\n    yield preparePairingAlert(shadowRoot, pairingPayload);\n  }\n\n  return id;\n});\n\nexport { closeAlert, closeAlerts, openAlert };","map":{"version":3,"sources":["../../../../src/ui/alert/Alert.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["// Taken from https://github.com/WalletConnect/walletconnect-monorepo/blob/master/packages/qrcode-modal/src/browser.ts\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { getColorMode } from '../../colorMode';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { replaceInTemplate } from '../../utils/replace-in-template';\nimport { alertTemplates } from './alert-templates';\nimport { preparePairingAlert } from './PairingAlert';\nlet lastFocusedElement;\nlet document;\nif (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n    document = window.document;\n}\nconst timeout = {};\nconst addQR = (dataString) => {\n    if (typeof dataString === 'string') {\n        return `<div id=\"beacon--qr__container\"><div id=\"beacon--qr__copy__container\"><button class=\"beacon-modal__button--outline\" id=\"beacon--qr__copy\">Copy</button></div></div>${dataString}`;\n    }\n    return '';\n};\nconst formatAlert = (id, body, title, buttons, hasPairingPayload) => {\n    const callToAction = title;\n    const buttonsHtml = buttons.map((button, index) => `<button id=\"beacon-alert-${id}-${index}\" class=\"beacon-modal__button${button.style === 'outline' ? '--outline' : ''}\">${button.text}</button>`);\n    let allStyles = alertTemplates.default.css;\n    if (hasPairingPayload) {\n        allStyles += alertTemplates.pair.css;\n    }\n    let alertContainer = alertTemplates.container;\n    alertContainer = replaceInTemplate(alertContainer, 'main', hasPairingPayload ? alertTemplates.pair.html : alertTemplates.default.html);\n    alertContainer = replaceInTemplate(alertContainer, 'callToAction', callToAction);\n    alertContainer = replaceInTemplate(alertContainer, 'buttons', buttonsHtml.join(' '));\n    alertContainer = replaceInTemplate(alertContainer, 'body', body);\n    alertContainer = replaceInTemplate(alertContainer, 'id', id);\n    if (alertContainer.indexOf('{{') >= 0) {\n        const start = alertContainer.indexOf('{{');\n        const end = alertContainer.indexOf('}}');\n        console.error('Not all placeholders replaced!', alertContainer.substr(start, end - start));\n        throw new Error('Not all placeholders replaced!');\n    }\n    return {\n        style: allStyles,\n        html: alertContainer\n    };\n};\n/**\n * Close an alert by ID\n *\n * @param id ID of alert\n */\nconst closeAlert = (id) => new Promise((resolve) => {\n    var _a;\n    const wrapper = document.getElementById(`beacon-alert-wrapper-${id}`);\n    if (!wrapper) {\n        return resolve();\n    }\n    const elm = (_a = wrapper.shadowRoot) === null || _a === void 0 ? void 0 : _a.getElementById(`beacon-alert-modal-${id}`);\n    if (elm) {\n        const animationDuration = 300;\n        const localTimeout = timeout[id];\n        if (localTimeout) {\n            clearTimeout(localTimeout);\n            timeout[id] = undefined;\n        }\n        elm.className = elm.className.replace('fadeIn', 'fadeOut');\n        window.setTimeout(() => {\n            const parent = wrapper.parentNode;\n            if (parent) {\n                parent.removeChild(wrapper);\n            }\n            if (lastFocusedElement) {\n                ;\n                lastFocusedElement.focus(); // set focus back to last focussed element\n            }\n            resolve();\n        }, animationDuration);\n    }\n    else {\n        resolve();\n    }\n});\n/**\n * Close all alerts\n */\nconst closeAlerts = () => __awaiter(void 0, void 0, void 0, function* () {\n    return new Promise((resolve) => __awaiter(void 0, void 0, void 0, function* () {\n        const openAlertElements = document.querySelectorAll('[id^=\"beacon-alert-wrapper-\"]');\n        if (openAlertElements.length > 0) {\n            const alertIds = [];\n            openAlertElements.forEach((element) => __awaiter(void 0, void 0, void 0, function* () {\n                alertIds.push(element.id.split('-')[3]);\n            }));\n            yield Promise.all(alertIds.map(closeAlert));\n            resolve();\n        }\n        else {\n            resolve();\n        }\n    }));\n});\n/**\n * Show an alert\n *\n * @param alertConfig The configuration of the alert\n */\n// eslint-disable-next-line complexity\nconst openAlert = (alertConfig) => __awaiter(void 0, void 0, void 0, function* () {\n    var _a, _b;\n    const body = alertConfig.body;\n    const title = alertConfig.title;\n    const timer = alertConfig.timer;\n    const pairingPayload = alertConfig.pairingPayload;\n    const disclaimer = alertConfig.disclaimerText;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const closeButtonCallback = alertConfig.closeButtonCallback;\n    yield closeAlerts();\n    const id = (yield generateGUID()).split('-').join('');\n    const shadowRootEl = document.createElement('div');\n    shadowRootEl.setAttribute('id', `beacon-alert-wrapper-${id}`);\n    const shadowRoot = shadowRootEl.attachShadow({ mode: 'open' });\n    const wrapper = document.createElement('div');\n    wrapper.setAttribute('tabindex', `0`); // Make modal focussable\n    shadowRoot.appendChild(wrapper);\n    const buttons = [\n        ...((_b = (_a = alertConfig.buttons) === null || _a === void 0 ? void 0 : _a.map((button) => {\n            var _a, _b;\n            return ({\n                text: button.text,\n                // eslint-disable-next-line @typescript-eslint/unbound-method\n                actionCallback: (_a = button.actionCallback) !== null && _a !== void 0 ? _a : (() => Promise.resolve()),\n                style: (_b = button.style) !== null && _b !== void 0 ? _b : 'outline'\n            });\n        })) !== null && _b !== void 0 ? _b : [])\n    ];\n    const formattedBody = pairingPayload ? addQR(body) : body !== null && body !== void 0 ? body : '';\n    const { style, html } = formatAlert(id, formattedBody, title, buttons, !!(pairingPayload === null || pairingPayload === void 0 ? void 0 : pairingPayload.p2pSyncCode));\n    wrapper.innerHTML = html;\n    const styleEl = document.createElement('style');\n    styleEl.textContent = style;\n    shadowRoot.appendChild(styleEl);\n    if (timer) {\n        timeout[id] = window.setTimeout(() => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeAlert(id);\n        }), timer);\n    }\n    document.body.prepend(shadowRootEl);\n    const closeButton = shadowRoot.getElementById(`beacon-alert-${id}-close`);\n    const closeButtonClick = () => __awaiter(void 0, void 0, void 0, function* () {\n        if (closeButtonCallback) {\n            closeButtonCallback();\n        }\n        yield closeAlert(id);\n    });\n    if (disclaimer) {\n        const disclaimerContainer = shadowRoot.getElementById(`beacon--disclaimer`);\n        if (disclaimerContainer) {\n            disclaimerContainer.innerHTML = disclaimer;\n        }\n    }\n    const colorMode = getColorMode();\n    const elm = shadowRoot.getElementById(`beacon-alert-modal-${id}`);\n    if (elm) {\n        elm.classList.add(`theme__${colorMode}`);\n        elm.addEventListener('click', closeButtonClick); // Backdrop click dismisses alert\n    }\n    const modal = shadowRoot.querySelectorAll('.beacon-modal__wrapper');\n    if (modal.length > 0) {\n        modal[0].addEventListener('click', (event) => {\n            event.stopPropagation();\n        });\n    }\n    lastFocusedElement = document.activeElement; // Store which element has been focussed before the alert is shown\n    wrapper.focus(); // Focus alert for accessibility\n    buttons.forEach((button, index) => {\n        const buttonElement = shadowRoot.getElementById(`beacon-alert-${id}-${index}`);\n        if (buttonElement) {\n            buttonElement.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n                yield closeAlert(id);\n                if (button.actionCallback) {\n                    yield button.actionCallback();\n                }\n            }));\n        }\n    });\n    if (closeButton) {\n        closeButton.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeButtonClick();\n        }));\n    }\n    window.addEventListener('keydown', (event) => __awaiter(void 0, void 0, void 0, function* () {\n        if (event.key === 'Escape') {\n            yield closeButtonClick();\n        }\n    }));\n    if (pairingPayload) {\n        yield preparePairingAlert(shadowRoot, pairingPayload);\n    }\n    return id;\n});\nexport { closeAlert, closeAlerts, openAlert };\n//# sourceMappingURL=Alert.js.map"]},"metadata":{},"sourceType":"module"}